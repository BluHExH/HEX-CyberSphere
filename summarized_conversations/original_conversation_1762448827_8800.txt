{'role': 'assistant', 'content': '<function_calls>\n<create-file file_path="HEX-CyberSphere/core_engine/data_parser.py">\n"""\nHEX-CyberSphere Data Parser\nHandles parsing and transformation of various data formats\n"""\n\nimport json\nimport yaml\nimport csv\nimport xml.etree.ElementTree as ET\nimport pandas as pd\nimport logging\nfrom typing import Dict, Any, List\n\nclass DataParser:\n    def __init__(self):\n        self.logger = logging.getLogger(__name__)\n    \n    def parse_json(self, data: str) -> Dict[Any, Any]:\n        """Parse JSON data"""\n        try:\n            return json.loads(data)\n        except json.JSONDecodeError as e:\n            self.logger.error(f"JSON parsing error: {e}")\n            return {\'error\': f\'JSON parsing failed: {str(e)}\'}\n    \n    def parse_yaml(self, data: str) -> Dict[Any, Any]:\n        """Parse YAML data"""\n        try:\n            return yaml.safe_load(data)\n        except yaml.YAMLError as e:\n            self.logger.error(f"YAML parsing error: {e}")\n            return {\'error\': f\'YAML parsing failed: {str(e)}\'}\n    \n    def parse_csv(self, data: str) -> List[Dict[str, Any]]:\n        """Parse CSV data"""\n        try:\n            lines = data.strip().split(\'\\n\')\n            reader = csv.DictReader(lines)\n            return list(reader)\n        except Exception as e:\n            self.logger.error(f"CSV parsing error: {e}")\n            return [{\'error\': f\'CSV parsing failed: {str(e)}\'}]\n    \n    def parse_xml(self, data: str) -> Dict[str, Any]:\n        """Parse XML data"""\n        try:\n            root = ET.fromstring(data)\n            return self._xml_to_dict(root)\n        except ET.ParseError as e:\n            self.logger.error(f"XML parsing error: {e}")\n            return {\'error\': f\'XML parsing failed: {str(e)}\'}\n    \n    def _xml_to_dict(self, element: ET.Element) -> Dict[str, Any]:\n        """Convert XML element to dictionary"""\n        result = {}\n        \n        # Add attributes\n        if element.attrib:\n            result[\'@attributes\'] = element.attrib\n        \n        # Add text content\n        if element.text and element.text.strip():\n            if len(element) == 0:\n                return element.text.strip()\n            result[\'#text\'] = element.text.strip()\n        \n        # Add children\n        for child in element:\n            child_data = self._xml_to_dict(child)\n            if child.tag in result:\n                if not isinstance(result[child.tag], list):\n                    result[child.tag] = [result[child.tag]]\n                result[child.tag].append(child_data)\n            else:\n                result[child.tag] = child_data\n        \n        return result\n    \n    def convert_format(self, data: Any, from_format: str, to_format: str) -> str:\n        """Convert data between formats"""\n        try:\n            if from_format == \'json\' and to_format == \'yaml\':\n                parsed = self.parse_json(data)\n                return yaml.dump(parsed, default_flow_style=False)\n            elif from_format == \'yaml\' and to_format == \'json\':\n                parsed = self.parse_yaml(data)\n                return json.dumps(parsed, indent=2)\n            elif from_format == \'csv\' and to_format == \'json\':\n                parsed = self.parse_csv(data)\n                return json.dumps(parsed, indent=2)\n            else:\n                return json.dumps({\'error\': f\'Conversion from {from_format} to {to_format} not supported\'})\n        except Exception as e:\n            self.logger.error(f"Format conversion error: {e}")\n            return json.dumps({\'error\': f\'Conversion failed: {str(e)}\'})\n\n# Example usage\nif __name__ == "__main__":\n    parser = DataParser()\n    \n    # Test JSON parsing\n    json_data = \'{"name": "HEX-CyberSphere", "version": "1.0.0", "features": ["AI", "Automation", "Security"]}\'\n    print("JSON Data:")\n    print(json.dumps(parser.parse_json(json_data), indent=2))\n    \n    # Test YAML parsing\n    yaml_data = """\n    name: HEX-CyberSphere\n    version: 1.0.0\n    features:\n      - AI\n      - Automation\n      - Security\n    """\n    print("\\nYAML Data:")\n    print(json.dumps(parser.parse_yaml(yaml_data), indent=2))\n    \n    # Test CSV parsing\n    csv_data = """name,version,feature\nHEX-CyberSphere,1.0.0,AI\nHEX-CyberSphere,1.0.0,Security\nHEX-CyberSphere,1.0.0,Web Automation"""\n    print("\\nCSV Data:")\n    print(json.dumps(parser.parse_csv(csv_data), indent=2))\n</create-file>\n</function_calls>'}