{'role': 'assistant', 'content': '<function_calls>\n<create-file file_path="HEX-CyberSphere/node_events/index.js">\n/**\n * HEX-CyberSphere Node.js Event System\n * Handles real-time communication and web automation\n */\n\nconst express = require(\'express\');\nconst http = require(\'http\');\nconst socketIo = require(\'socket.io\');\nconst puppeteer = require(\'puppeteer\');\nconst axios = require(\'axios\');\n\n// Create Express app\nconst app = express();\nconst server = http.createServer(app);\nconst io = socketIo(server, {\n  cors: {\n    origin: "*",\n    methods: ["GET", "POST"]\n  }\n});\n\n// Middleware\napp.use(express.json());\napp.use(express.static(\'../web_dashboard\'));\n\n// Store active browser instances\nconst browserInstances = new Map();\n\n// Display banner\nconsole.log("╔════════════════════════════════════════════════╗");\nconsole.log("║              ⚡ H E X – C Y B E R S P H E R E ⚡              ║");\nconsole.log("╚════════════════════════════════════════════════╝");\nconsole.log("     Node.js Event System & Web Automation");\nconsole.log("  Listening on port 3000");\nconsole.log("");\n\n// Health check endpoint\napp.get(\'/health\', (req, res) => {\n  res.json({\n    status: \'healthy\',\n    service: \'node_events\',\n    timestamp: new Date().toISOString()\n  });\n});\n\n// Web automation endpoint\napp.post(\'/automate\', async (req, res) => {\n  try {\n    const { url, actions, headless = true } = req.body;\n    \n    console.log(`Starting web automation for: ${url}`);\n    \n    // Launch browser\n    const browser = await puppeteer.launch({ \n      headless: headless,\n      args: [\'--no-sandbox\', \'--disable-setuid-sandbox\']\n    });\n    \n    const page = await browser.newPage();\n    \n    // Navigate to URL\n    await page.goto(url, { waitUntil: \'networkidle2\' });\n    \n    // Execute actions\n    let results = [];\n    if (actions && Array.isArray(actions)) {\n      for (const action of actions) {\n        try {\n          let result;\n          switch (action.type) {\n            case \'click\':\n              await page.click(action.selector);\n              result = `Clicked on ${action.selector}`;\n              break;\n            case \'type\':\n              await page.type(action.selector, action.text);\n              result = `Typed "${action.text}" into ${action.selector}`;\n              break;\n            case \'screenshot\':\n              const screenshot = await page.screenshot({ encoding: \'base64\' });\n              result = { screenshot, message: \'Screenshot taken\' };\n              break;\n            case \'extract\':\n              const extracted = await page.evaluate((selector) => {\n                const element = document.querySelector(selector);\n                return element ? element.textContent : null;\n              }, action.selector);\n              result = { extracted, selector: action.selector };\n              break;\n            default:\n              result = `Unknown action type: ${action.type}`;\n          }\n          results.push({ action: action.type, result });\n        } catch (error) {\n          results.push({ action: action.type, error: error.message });\n        }\n      }\n    }\n    \n    // Close browser\n    await browser.close();\n    \n    // Emit event to all connected clients\n    io.emit(\'automation_complete\', {\n      url,\n      actions: actions?.length || 0,\n      results,\n      timestamp: new Date().toISOString()\n    });\n    \n    res.json({\n      status: \'success\',\n      url,\n      actions_executed: actions?.length || 0,\n      results\n    });\n  } catch (error) {\n    console.error(\'Web automation error:\', error);\n    res.status(500).json({\n      status: \'error\',\n      message: error.message\n    });\n  }\n});\n\n// Get browser instances\napp.get(\'/browsers\', (req, res) => {\n  const instances = Array.from(browserInstances.entries()).map(([id, info]) => ({\n    id,\n    url: info.url,\n    createdAt: info.createdAt\n  }));\n  \n  res.json({\n    status: \'success\',\n    instances,\n    count: instances.length\n  });\n});\n\n// WebSocket connection handling\nio.on(\'connection\', (socket) => {\n  console.log(`Client connected: ${socket.id}`);\n  \n  // Send system status to new client\n  socket.emit(\'system_status\', {\n    status: \'online\',\n    service: \'node_events\',\n    timestamp: new Date().toISOString()\n  });\n  \n  // Handle real-time data requests\n  socket.on(\'request_data\', (data) => {\n    console.log(`Data request from ${socket.id}:`, data);\n    \n    // Emit sample real-time data\n    socket.emit(\'realtime_data\', {\n      metric: \'cpu_usage\',\n      value: Math.random() * 100,\n      timestamp: new Date().toISOString()\n    });\n  });\n  \n  // Handle task status updates\n  socket.on(\'task_update\', (taskData) => {\n    console.log(`Task update from ${socket.id}:`, taskData);\n    \n    // Broadcast to all clients\n    io.emit(\'task_status\', taskData);\n  });\n  \n  // Handle disconnect\n  socket.on(\'disconnect\', () => {\n    console.log(`Client disconnected: ${socket.id}`);\n  });\n});\n\n// Periodic data emission\nsetInterval(() => {\n  io.emit(\'system_metrics\', {\n    cpu: Math.random() * 100,\n    memory: Math.random() * 100,\n    network: Math.random() * 1000,\n    timestamp: new Date().toISOString()\n  });\n}, 5000);\n\n// Start server\nconst PORT = process.env.PORT || 3000;\nserver.listen(PORT, () => {\n  console.log(`HEX-CyberSphere Node.js Event System running on port ${PORT}`);\n});\n\n// Graceful shutdown\nprocess.on(\'SIGTERM\', () => {\n  console.log(\'Shutting down Node.js Event System...\');\n  server.close(() => {\n    console.log(\'Server closed\');\n    process.exit(0);\n  });\n});\n\nprocess.on(\'SIGINT\', () => {\n  console.log(\'Shutting down Node.js Event System...\');\n  server.close(() => {\n    console.log(\'Server closed\');\n    process.exit(0);\n  });\n});\n</create-file>\n</function_calls>'}